# Opencode 复用计划（不绑架主干架构）

定位

- Opencode 作为优秀实现的“模块与思路来源”，而非 DevMinds.ai 的架构母体。
- 我们仅在“与本项目契约吻合”的前提下择优复用，必要时做隔离层。

复用优先级

1. 接口与协议层（优先）

- 后端/Agent 侧的模型清单与请求封装的通用思路（配置来源为 .minds/provider.yaml；不提供前端 UI）
- 事件类型与 span 折叠的展示经验

2. 工具与适配层（可选）

- 工具注册/执行的抽象与少量工具实现

3. 交互与 UI 细节（参考）

- TUI 的命令、状态、消息分层用于 Web 等价交互设计

边界与约束

- 不直接耦合内部目录结构与私有类型；通过本项目定义的 API/WS 契约接入
- 不引入其密钥/鉴权做法；沿用本项目“无密钥落盘”的安全规范
- 任何复用均有“退出机制”：可替换为等价实现，不影响主干

集成策略

- 以 adapter 适配：将 opencode 的能力包裹为符合 DevMinds.ai 契约的后端 provider/tool（仅用于后端/Agent；前端不展示）
- 差异点记录在本文件，必要时在 PR 模板中强制评审“是否跨越边界”

验证与回退

- 通过 design/cases 下 TDD 场景验证兼容性
- 一旦出现冲突，优先主干契约，关闭复用或替换实现
